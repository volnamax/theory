–ö–û–†–£–¢–ò–ù –ë–ò–õ–î–ï–†–´ 
### 35. `Launch` vs `Async` –≤ Kotlin –ö–æ—Ä—É—Ç–∏–Ω–∞—Ö

| **–§—É–Ω–∫—Ü–∏—è** | **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç** | **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ**                                                            | **–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?**                                                                |
| ----------- | -------------- | ------------------------------------------------------------------------- | -------------------------------------------------------------------------------------- |
| `launch {}` | `Job`          | –ó–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ—Ä—É—Ç–∏–Ω—É **–±–µ–∑ –≤–æ–∑–≤—Ä–∞—Ç–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞** (fire-and-forget)          | –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI, –∑–∞–ø–∏—Å—å –≤ –±–∞–∑—É, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ) |
| `async {}`  | `Deferred<T>`  | –ó–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ—Ä—É—Ç–∏–Ω—É –∏ **–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç** (–∞–Ω–∞–ª–æ–≥ `Future`/`Promise`) | –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π                    |

---

–ß—Ç–æ —Ç–∞–∫–æ–µ Job –∏ –∫–∞–∫ –æ—Ç–º–µ–Ω–∏—Ç—å –∫–æ—Ä—É—Ç–∏–Ω—É?

üí¨ –û—Ç–≤–µ—Ç: "Job —É–ø—Ä–∞–≤–ª—è–µ—Ç –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –∫–æ—Ä—É—Ç–∏–Ω—ã –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –µ–µ –æ—Ç–º–µ–Ω–∏—Ç—å."

‚úÖ –ü—Ä–∏–º–µ—Ä –æ—Ç–º–µ–Ω—ã –∫–æ—Ä—É—Ç–∏–Ω—ã:

```java
fun main() = runBlocking {
	val job = launch {
	repeat(1000) { println("–†–∞–±–æ—Ç–∞—é...") }
}
	delay(100)
	job.cancel() // –û—Ç–º–µ–Ω—è–µ—Ç –∫–æ—Ä—É—Ç–∏–Ω—É
}
```

üëâ –í–∞–∂–Ω–æ! –ò—Å–ø–æ–ª—å–∑—É–π isActive, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä—è—Ç—å, –æ—Ç–º–µ–Ω–µ–Ω–∞ –ª–∏ –∫–æ—Ä—É—Ç–∏–Ω–∞.

**1Ô∏è‚É£ `launch {}` ‚Äì –ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏ –∫–æ—Ä—É—Ç–∏–Ω—É**

launch –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –Ω–∞–º –Ω–µ –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –≠—Ç–æ —É–¥–æ–±–Ω—ã–π —Å–ø–æ—Å–æ–± –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ñ–æ–Ω–æ–≤—É—é –∑–∞–¥–∞—á—É, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∑–∞–ø—Ä–æ—Å –≤ —Å–µ—Ç—å –∏–ª–∏ –∑–∞–ø–∏—Å—å –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.

```kotlin
fun main() = runBlocking {
	launch {
		delay(1000)
		println("Task completed!")
}
	println("This prints first!")
}
```

–í—ã–≤–æ–¥:

This prints first! Task completed!

üî• –í–∞–∂–Ω–æ–µ: launch –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –ø–æ—ç—Ç–æ–º—É –Ω–µ–ª—å–∑—è –ø—Ä–∏—Å–≤–æ–∏—Ç—å val result = launch {}. 2Ô∏è‚É£ **async {} ‚Äì –ó–∞–ø—É—Å–∫–∞–µ—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç**

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å –¥–∞–Ω–Ω—ã–µ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è async. –û–Ω –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç Deferred<T>, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ —è–≤–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Å –ø–æ–º–æ—â—å—é .await().

```kotlin
fun main() = runBlocking {
		val result = async {
				delay(1000)
				"Hello from async!"
		}
println("Waiting for result...")
println(result.await()) // –ñ–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∫–æ—Ä—É—Ç–∏–Ω—ã
}
```

–í—ã–≤–æ–¥:

Waiting for result... Hello from async!

üî• –í–∞–∂–Ω–æ: async —Å—Ä–∞–∑—É –Ω–µ –≤—ã—á–∏—Å–ª—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Äì –µ–≥–æ –Ω–∞–¥–æ —è–≤–Ω–æ –∑–∞–ø—Ä–æ—Å–∏—Ç—å —á–µ—Ä–µ–∑ .await(). 3Ô∏è‚É£ launch vs async –≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏—è—Ö ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: –ó–∞–ø—É—Å–∫–∞–µ–º launch, –Ω–æ –Ω–µ –º–æ–∂–µ–º –≤–µ—Ä–Ω—É—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç

```kotlin
fun main() = runBlocking {
var result = ""
launch {
    delay(1000)
    result = "Hello"
}

println(result) // –í—ã–≤–µ–¥–µ—Ç "", –ø–æ—Ç–æ–º—É —á—Ç–æ launch –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ—Ç–æ–∫

```

‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ–º async –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á

```kotlin
fun main() = runBlocking {
val first = async {
		delay(1000)
		"First"
}
val second = async {
	delay(1000)
	"Second"
}
println("${first.await()} ${second.await()}") // –û–∂–∏–¥–∞–µ–º –æ–±–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
```

‚è≥ –û–±–∞ async –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ, –∏ –º—ã –ø–æ–ª—É—á–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Å–ª–µ await(). 4Ô∏è‚É£ –ì–ª–∞–≤–Ω–æ–µ –æ—Ç–ª–∏—á–∏–µ ‚Äì –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

```
launch {} ‚Üí –û—à–∏–±–∫–∞ –∫—Ä–∞—à–∏—Ç –≤—Å—é –∫–æ—Ä—É—Ç–∏–Ω—É.
async {} ‚Üí –û—à–∏–±–∫–∞ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –¥–∞–ª—å—à–µ –∏ –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ await().

```

–ü—Ä–∏–º–µ—Ä —Å launch (–∫—Ä–∞—à–∏—Ç –∫–æ—Ä—É—Ç–∏–Ω—É)

```kotlin
fun main() = runBlocking {
	val job = launch {
		throw RuntimeException("Something went wrong")
}
	job.join() // –ñ–¥–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è (–∏ –∫—Ä–∞—à–∏—Ç—Å—è)
}
```

–ü—Ä–∏–º–µ—Ä —Å async (–æ—à–∏–±–∫–∞ –ø–æ—è–≤–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ await())

```kotlin
fun main() = runBlocking {
	val deferred = async {
	throw RuntimeException("Something went wrong")
}
try {
    deferred.await() // –û—à–∏–±–∫–∞ –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å
} catch (e: Exception) {
    println("Caught exception: ${e.message}")
}
```

‚è≥ –í—ã–≤–æ–¥:

Caught exception: Something went wrong

üî• async –º–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —á–µ—Ä–µ–∑ try/catch.

```
launch ‚Üí –µ—Å–ª–∏ –Ω–µ –Ω—É–∂–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
async + await() ‚Üí –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ

```

### üìå –ß—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `launch` –≤ Kotlin?

–§—É–Ω–∫—Ü–∏—è `launch {}` **–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç —Ç–∏–ø–∞ `Job`**, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω—è–µ–º—É—é –∫–æ—Ä—É—Ç–∏–Ω—É.

### **üîπ Job ‚Äì —ç—Ç–æ "–¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä" –∫–æ—Ä—É—Ç–∏–Ω—ã**

- `Job` –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ—Ä—É—Ç–∏–Ω–æ–π (–æ—Ç–º–µ–Ω–∞, –æ–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è).
- `Job` **–Ω–µ** –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ—Ä—É—Ç–∏–Ω—ã (–≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç `async`).
- –ö–æ—Ä—É—Ç–∏–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è `launch {}` **–≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `Job` –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ**, –Ω–µ –¥–æ–∂–∏–¥–∞—è—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∫–æ—Ä—É—Ç–∏–Ω—ã.

|**–°–∏—Ç—É–∞—Ü–∏—è**|**launch**|**async**|
|---|---|---|
|–ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ—Ä—É—Ç–∏–Ω—É (UI, –∑–∞–ø–∏—Å—å –≤ –ë–î)|‚úÖ|‚ùå|
|–í—ã–ø–æ–ª–Ω–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á –∏ –≤–µ—Ä–Ω—É—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç|‚ùå|‚úÖ|
|–ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ—Ä—É—Ç–∏–Ω—É, –Ω–æ –Ω–µ –∂–¥–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç|‚úÖ|‚ùå|
|–ü–µ—Ä–µ—Ö–≤–∞—Ç –æ—à–∏–±–æ–∫ (`try/catch`)|‚ùå (–û—à–∏–±–∫–∞ –ª–æ–º–∞–µ—Ç –≤—Å—é –∫–æ—Ä—É—Ç–∏–Ω—É)|‚úÖ (–û—à–∏–±–∫–∞ –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ `await()`)|

[[kotlin]]
[[withContext]]