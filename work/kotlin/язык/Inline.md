Inline —Ñ—É–Ω–∫—Ü–∏–∏ –≤ Kotlin ‚Äì –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –∏ –∑–∞—á–µ–º –Ω—É–∂–Ω—ã?
üìå –ß—Ç–æ —Ç–∞–∫–æ–µ inline —Ñ—É–Ω–∫—Ü–∏–∏?

–ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ inline —É–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä—É, —á—Ç–æ –∫–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏ –±—É–¥–µ—Ç –≤—Å—Ç–∞–≤–ª–µ–Ω –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤ –º–µ—Å—Ç–æ –≤—ã–∑–æ–≤–∞, –∞ –Ω–µ –≤—ã–∑—ã–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ –æ–±—ã—á–Ω—ã–π –≤—ã–∑–æ–≤ –º–µ—Ç–æ–¥–∞.

üîπ –¶–µ–ª—å inline ‚Äì —É–º–µ–Ω—å—à–∏—Ç—å –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ –ª—è–º–±–¥–∞-—Ñ—É–Ω–∫—Ü–∏–π.
üîπ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç inline?
–ü—Ä–∏–º–µ—Ä –±–µ–∑ inline (–æ–±—ã—á–Ω—ã–π –≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏)
```kotlin
fun printMessage(message: () -> Unit) {
    println("–î–æ –≤—ã–∑–æ–≤–∞ –ª—è–º–±–¥—ã")
    message()
    println("–ü–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ –ª—è–º–±–¥—ã")
}

fun main() {
    printMessage { println("–≠—Ç–æ –ª—è–º–±–¥–∞") }
}
```

‚úÖ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –±–∞–π—Ç–∫–æ–¥–µ?

    –ü—Ä–∏ –≤—ã–∑–æ–≤–µ printMessage, —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π –æ–±—ä–µ–∫—Ç Function (–∞–Ω–æ–Ω–∏–º–Ω—ã–π –∫–ª–∞—Å—Å).
    JVM –ø–µ—Ä–µ–¥–∞–µ—Ç –µ–≥–æ –∫–∞–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä.
    –í—ã–∑—ã–≤–∞–µ—Ç –º–µ—Ç–æ–¥ invoke() –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–¥–∞ –ª—è–º–±–¥—ã.

–ü—Ä–∏–º–µ—Ä —Å inline
```kotlin
inline fun printMessage(message: () -> Unit) {
    println("–î–æ –≤—ã–∑–æ–≤–∞ –ª—è–º–±–¥—ã")
    message()
    println("–ü–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ –ª—è–º–±–¥—ã")
}

fun main() {
    printMessage { println("–≠—Ç–æ –ª—è–º–±–¥–∞") }
}

```

‚úÖ –ß—Ç–æ –¥–µ–ª–∞–µ—Ç inline?

    –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –≤—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–µ–ª–æ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –º–µ—Å—Ç–æ –≤—ã–∑–æ–≤–∞.
    –ò–∑–±–µ–≥–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ –ª—è–º–±–¥—ã.
    –£–º–µ–Ω—å—à–∞–µ—Ç –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ –≤—ã–∑–æ–≤—ã —Ñ—É–Ω–∫—Ü–∏–π.
## **üîπ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ `inline`**

|‚úÖ –ü–ª—é—Å—ã|üî¥ –ú–∏–Ω—É—Å—ã|
|---|---|
|**–£–º–µ–Ω—å—à–∞–µ—Ç –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã** ‚Äì –Ω–µ—Ç —Å–æ–∑–¥–∞–Ω–∏—è –∞–Ω–æ–Ω–∏–º–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ –∏ –≤—ã–∑–æ–≤–∞ –º–µ—Ç–æ–¥–∞|**–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –±–∞–π—Ç–∫–æ–¥–∞** ‚Äì –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `inline` —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç–æ|
|**–û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É —Å –ª—è–º–±–¥–∞–º–∏** ‚Äì –æ—Å–æ–±–µ–Ω–Ω–æ –≤ —Ü–∏–∫–ª–∞—Ö|**–ù–µ –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å `inline`** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `reified` —Ç—Ä–µ–±—É–µ—Ç `inline`)|
|**–ß—É—Ç—å –±—ã—Å—Ç—Ä–µ–µ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞—è—Ö** (—ç–∫–æ–Ω–æ–º–∏—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤)|**–ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π —Å —Ä–µ–∫—É—Ä—Å–∏–µ–π**|
# üîπ noinline ‚Äì –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –ª—è–º–±–¥ –∏–∑ inline

–ò–Ω–æ–≥–¥–∞ —á–∞—Å—Ç—å –ª—è–º–±–¥ –Ω–µ –Ω—É–∂–Ω–æ –∏–Ω–ª–∞–π–Ω–∏—Ç—å:

```kotlin
inline fun processData(
    crossinline onStart: () -> Unit,
    noinline onComplete: () -> Unit
) {
    onStart()  // –í—Å—Ç–∞–≤–∏—Ç—Å—è –≤ –∫–æ–¥
    onComplete()  // –ë—É–¥–µ—Ç –ø–µ—Ä–µ–¥–∞–Ω –∫–∞–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä (–Ω–µ inline)
}
```


üîπ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å noinline?

    –ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞—ë–º –ª—è–º–±–¥—É –≤ –¥—Ä—É–≥–æ–π –º–µ—Ç–æ–¥ –∏–ª–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –µ—ë –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é.
    –ï—Å–ª–∏ –Ω–µ —Ö–æ—Ç–∏–º —Ä–∞–∑–¥—É–≤–∞—Ç—å –±–∞–π—Ç–∫–æ–¥.

# üîπ crossinline ‚Äì –∑–∞–ø—Ä–µ—Ç return

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ inline –ª—è–º–±–¥–∞—Ö –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å return, —á—Ç–æ–±—ã –∑–∞–≤–µ—Ä—à–∏—Ç—å —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫—É—é —Ñ—É–Ω–∫—Ü–∏—é:

```kotlin 
inline fun execute(block: () -> Unit) {
    block()
    println("–≠—Ç–æ—Ç –∫–æ–¥ –Ω–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è, –µ—Å–ª–∏ –±—ã–ª return –≤ –ª—è–º–±–¥–µ!")
}

fun main() {
    execute {
        println("–ù–∞—á–∞–ª–æ")
        return  // –í—ã–π–¥–µ—Ç –∏–∑ `main`
    }
}
```


‚ùó –ü—Ä–æ–±–ª–µ–º–∞: –µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–µ–º –ª—è–º–±–¥—É –≤ –¥—Ä—É–≥–æ–π –ø–æ—Ç–æ–∫ –∏–ª–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –≤—ã–∑–æ–≤, return –≤—ã–∑–æ–≤–µ—Ç –æ—à–∏–±–∫—É.

‚úÖ –†–µ—à–µ–Ω–∏–µ ‚Äì crossinline

```kotlin
inline fun execute(crossinline block: () -> Unit) {
    Thread { block() }.start()  // –¢–µ–ø–µ—Ä—å `return` –∑–∞–ø—Ä–µ—â–µ–Ω
}
```

crossinline –∑–∞–ø—Ä–µ—â–∞–µ—Ç return –≤–Ω—É—Ç—Ä–∏ –ª—è–º–±–¥—ã, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–µ—Ä—à–µ–Ω–∏–π —Ñ—É–Ω–∫—Ü–∏–π.

# üîπ reified ‚Äì –¥–æ—Å—Ç—É–ø –∫ T –≤ inline

–û–±—ã—á–Ω–æ generic-—Ç–∏–ø—ã (T) —Å—Ç–∏—Ä–∞—é—Ç—Å—è –≤ –±–∞–π—Ç–∫–æ–¥–µ:

```kotlin 
fun <T> printType() {
    println(T::class.java)  // –û—à–∏–±–∫–∞: T –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
}
```


‚úÖ –†–∞–∑–±–æ—Ä inline –∏ reified –≤ Kotlin
1. –ü—Ä–æ–±–ª–µ–º–∞ –¥–∂–µ–Ω–µ—Ä–∏–∫–æ–≤ –≤ Kotlin (–∏ Java)

–í Java –∏ Kotlin –¥–∂–µ–Ω–µ—Ä–∏–∫–∏ —Å—Ç–∏—Ä–∞—é—Ç—Å—è (Type Erasure) –Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã (runtime) —Ç–∏–ø T —É–∂–µ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω.

üîπ –ü—Ä–∏–º–µ—Ä –ø—Ä–æ–±–ª–µ–º—ã:
```kotlin
fun <T> printType() {
    println(T::class.java) // –û—à–∏–±–∫–∞! –ù–µ–ª—å–∑—è –ø–æ–ª—É—á–∏—Ç—å –∫–ª–∞—Å—Å T
}
```
üí• –û—à–∏–±–∫–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏:
    "Cannot use 'T' as a reified type parameter. Use a class instead."

–ü—Ä–∏—á–∏–Ω–∞: –ø—Ä–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ JVM —É–¥–∞–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ T, –∏ –≤ —Ä–∞–Ω—Ç–∞–π–º–µ –µ–≥–æ –ø—Ä–æ—Å—Ç–æ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.
2. –†–µ—à–µ–Ω–∏–µ —á–µ—Ä–µ–∑ inline + reified

üîπ –ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è:

    –ï—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è inline, –∫–æ–¥ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è (–∏–Ω–ª–∞–π–Ω–∏–Ω–≥) –ø—Ä—è–º–æ –≤ –º–µ—Å—Ç–æ –≤—ã–∑–æ–≤–∞.
    –ï—Å–ª–∏ —Ç–∏–ø T –ø–æ–º–µ—á–µ–Ω –∫–∞–∫ reified, –æ–Ω —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–µ–±–µ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è!

üìå –†–∞–±–æ—á–∏–π –∫–æ–¥ —Å reified:

```kotlin
inline fun <reified T> printType() {
    println(T::class.java) // –¢–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç!
}

fun main() {
    printType<String>()  // class java.lang.String
    printType<Int>()     // class java.lang.Integer
}
```


‚úîÔ∏è –¢–µ–ø–µ—Ä—å T::class.java –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è, –ø–æ—Ç–æ–º—É —á—Ç–æ T –Ω–µ —Å—Ç–∏—Ä–∞–µ—Ç—Å—è, –∞ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –∫–∞–∫ —Ä–µ–∞–ª—å–Ω—ã–π —Ç–∏–ø.
3. –ö–æ–≥–¥–∞ reified –ø–æ–ª–µ–∑–µ–Ω?

üëâ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ JSON –ø–∞—Ä—Å–∏–Ω–≥–µ (Gson, Moshi, Retrofit) –ë–µ–∑ reified –º—ã –¥–æ–ª–∂–Ω—ã –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å Class<T> –≤—Ä—É—á–Ω—É—é:

val user = Gson().fromJson(jsonString, User::class.java)

–ù–æ —Å inline fun <reified T> –º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏—Å—å –±–µ–∑ –ø–µ—Ä–µ–¥–∞—á–∏ Class<T>:

inline fun <reified T> Gson.fromJson(json: String): T {
    return this.fromJson(json, T::class.java)
}

val user = Gson().fromJson<User>(jsonString)

‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ: –ë–æ–ª–µ–µ —á–∏—Å—Ç—ã–π –∏ —É–¥–æ–±–Ω—ã–π –∫–æ–¥!\

üìå –ò—Ç–æ–≥

‚úÖ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å inline?

    –ï—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ª—è–º–±–¥—ã –∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —á–∞—Å—Ç–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –∫–æ–ª–ª–µ–∫—Ü–∏—è—Ö).
    –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–∑–±–µ–∂–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤-–ª—è–º–±–¥ (—É–º–µ–Ω—å—à–∏—Ç—å –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã).
    –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã.

üö´ –ö–æ–≥–¥–∞ –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å inline?

    –ï—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –±–æ–ª—å—à–∞—è ‚Äì —ç—Ç–æ —Ä–∞–∑–¥—É–≤–∞–µ—Ç –±–∞–π—Ç–∫–æ–¥.
    –ï—Å–ª–∏ –Ω–µ—Ç –ª—è–º–±–¥ ‚Äì —Å–º—ã—Å–ª–∞ –≤ inline –Ω–µ—Ç.
    –ï—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è ‚Äì inline –Ω–µ–ª—å–∑—è –ø—Ä–∏–º–µ–Ω–∏—Ç—å.

‚úÖ –ö–æ–≥–¥–∞ noinline?

    –ï—Å–ª–∏ –Ω–µ –≤—Å–µ –ª—è–º–±–¥—ã –Ω—É–∂–Ω–æ –∏–Ω–ª–∞–π–Ω–∏—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–µ—Ä–µ–¥–∞–µ–º –≤ –¥—Ä—É–≥–æ–π –º–µ—Ç–æ–¥).

‚úÖ –ö–æ–≥–¥–∞ crossinline?

    –ï—Å–ª–∏ –ª—è–º–±–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ –¥—Ä—É–≥–æ–º –ø–æ—Ç–æ–∫–µ –∏ –Ω–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å return.

‚úÖ –ö–æ–≥–¥–∞ reified?

    –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Ç–∏–ø T –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

üìå –í—ã–≤–æ–¥:
inline —É—Å–∫–æ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç—É —Å –ª—è–º–±–¥–∞–º–∏, –Ω–æ —Ä–∞–∑–¥—É–≤–∞–µ—Ç –∫–æ–¥. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ —Ä–∞–∑—É–º–Ω–æ! üöÄ

### **–†–∞–∑–Ω–∏—Ü–∞ `inline`, `noinline`, `crossinline`**

|**–ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ**|**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç?**|
|---|---|
|`inline`|–í—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∫–æ–¥ –ª—è–º–±–¥—ã (–∏–∑–±–µ–≥–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤)|
|`noinline`|–ù–ï –≤—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ª—è–º–±–¥—É, —Å–æ–∑–¥–∞–µ—Ç—Å—è –æ–±—ä–µ–∫—Ç|
|`crossinline`|–í—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç, –Ω–æ –∑–∞–ø—Ä–µ—â–∞–µ—Ç `return` –≤–Ω—É—Ç—Ä–∏ –ª—è–º–±–¥—ã|

[[kotlin]]