### `withContext` –≤ Kotlin Coroutines

`withContext` ‚Äî —ç—Ç–æ **–ø—Ä–∏–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—â–∞—è** (`suspend`) —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∫–æ–¥ –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–º **–¥–∏—Å–ø–µ—Ç—á–µ—Ä–µ** (`Dispatcher`) –∏ **–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç**.

–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç `launch` –∏–ª–∏ `async`, **–æ–Ω–∞ –ù–ï —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é –∫–æ—Ä—É—Ç–∏–Ω—É**, –∞ –ø—Ä–æ—Å—Ç–æ **–ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**.

üìå –°–∏–Ω—Ç–∞–∫—Å–∏—Å

```java
suspend fun <T> withContext(context: CoroutineContext, block: suspend () -> T): T
```

```
context ‚Üí Dispatchers.Main, Dispatchers.IO, Dispatchers.Default, Dispatchers.Unconfined.
block ‚Üí –ö–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å.
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ (T).

```

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è withContext

–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —É –Ω–∞—Å –µ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏—è, –∑–∞–≥—Ä—É–∂–∞—é—â–∞—è –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å–µ—Ç–∏ –∏ –æ–±–Ω–æ–≤–ª—è—é—â–∞—è UI.

```java
import kotlinx.coroutines.*

fun main() = runBlocking {
    println("–ó–∞–ø—É—Å–∫ –Ω–∞ –ø–æ—Ç–æ–∫–µ: ${Thread.currentThread().name}")

    val result = withContext(Dispatchers.IO) { // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ IO-–ø–æ—Ç–æ–∫
        println("–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –ø–æ—Ç–æ–∫–µ: ${Thread.currentThread().name}")
        delay(1000) // –°–∏–º—É–ª—è—Ü–∏—è —Å–µ—Ç–µ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
        "–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã"
    }

    println("–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI –Ω–∞ –ø–æ—Ç–æ–∫–µ: ${Thread.currentThread().name}")
    println(result)
}

```

- –ö–æ–¥ –Ω–∞—á–∞–ª—Å—è –≤ `main` –ø–æ—Ç–æ–∫–µ.
- `withContext(Dispatchers.IO) {}` –ø–µ—Ä–µ–∫–ª—é—á–∏–ª –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞ IO-–ø–æ—Ç–æ–∫ –¥–ª—è —Å–µ—Ç–µ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞.
- –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è `withContext` –≤–µ—Ä–Ω—É–ª –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤ `main`

–ù–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å withContext –í–ù–£–¢–†–ò launch {} –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

–ü–ª–æ—Ö–æ:

```java
launch {
withContext([Dispatchers.IO](<http://dispatchers.io/>)) {
// –î–æ–ª–≥–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è
	}
}
```

‚õî –ü–æ—á–µ–º—É?

```
launch {} —É–∂–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ—Ä—É—Ç–∏–Ω—É, withContext –ª–∏—à—å –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç.
–õ—É—á—à–µ —Å—Ä–∞–∑—É –∑–∞–ø—É—Å–∫–∞—Ç—å launch(Dispatchers.IO) {}!

```

–•–æ—Ä–æ—à–æ:

```java
launch([Dispatchers.IO](<http://dispatchers.io/>)) {
// –î–æ–ª–≥–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è
}
```

üéØ –ò—Ç–æ–≥

‚úî withContext –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–º–µ–Ω—ã –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤–Ω—É—Ç—Ä–∏ –∫–æ—Ä—É—Ç–∏–Ω—ã. 
‚úî –ù–µ —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é –∫–æ—Ä—É—Ç–∏–Ω—É, –∞ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ –∂–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –±–ª–æ–∫–∞.
‚úî –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. 
‚úî –û—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, IO ‚Üí Main).

üî• –ö–∞–∫ –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏? "withContext ‚Äî —ç—Ç–æ suspend-—Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç –ø–æ—Ç–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤–Ω—É—Ç—Ä–∏ –∫–æ—Ä—É—Ç–∏–Ω—ã –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –û–Ω–∞ –Ω–µ —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é –∫–æ—Ä—É—Ç–∏–Ω—É, –∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–¥ –≤ –¥—Ä—É–≥–æ–º –ø–æ—Ç–æ–∫–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∑–∞–ø—Ä–æ—Å –≤ [Dispatchers.IO](http://dispatchers.io/), –∞ –∑–∞—Ç–µ–º –æ–±–Ω–æ–≤–∏—Ç—å UI –≤ Dispatchers.Main. [[Dispatchers]]

[[kotlin]]