**Service** ‚Äì —ç—Ç–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –¥–ª–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ –∏ –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞. –î—Ä—É–≥–∏–º–∏ —Å–ª–æ–≤–∞–º–∏, —ç—Ç–æ —Å–ø–æ—Å–æ–± –≤—ã–ø–æ–ª–Ω–∏—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –≤ —Ñ–æ–Ω–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–Ω–∏–µ –º—É–∑—ã–∫–∏, –∑–∞–≥—Ä—É–∑–∫—É —Ñ–∞–π–ª–æ–≤ –∏ —Ç. –¥., –±–µ–∑ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º. –°–µ—Ä–≤–∏—Å—ã –º–æ–≥—É—Ç –±—ã—Ç—å –∫–∞–∫ —Å–≤—è–∑–∞–Ω–Ω—ã–º–∏ (bound), —Ç–∞–∫ –∏ –Ω–µ—Å–≤—è–∑–∞–Ω–Ω—ã–º–∏. –°–≤—è–∑–∞–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç-—Å–µ—Ä–≤–µ—Ä–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏) –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å —Å–µ—Ä–≤–∏—Å–æ–º, –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞–ø—Ä–æ—Å—ã, –ø–æ–ª—É—á–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —á–µ—Ä–µ–∑ IPC (–ú–µ–∂–ø—Ä–æ—Ü–µ—Å—Å–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ). –ù–µ—Å–≤—è–∑–∞–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å –æ–±—ã—á–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞ –∑–∞–¥–Ω–µ–º –ø–ª–∞–Ω–µ –∏ –Ω–µ —Å–≤—è–∑–∞–Ω —Å –∫–∞–∫–∏–º-–ª–∏–±–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –∏–ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º, –∫–æ—Ç–æ—Ä—ã–π –µ–≥–æ –∑–∞–ø—É—Å—Ç–∏–ª.

## **1Ô∏è‚É£ –í–∏–¥—ã `Service` –≤ Android**

### üîπ **–ù–µ—Å–≤—è–∑–∞–Ω–Ω—ã–π (`Started`)**

üìå –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –∫–æ–≥–¥–∞ —Å–µ—Ä–≤–∏—Å **–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ**, –¥–∞–∂–µ –µ—Å–ª–∏ –≤—ã–∑—ã–≤–∞—é—â–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, `Activity`) —É–Ω–∏—á—Ç–æ–∂–µ–Ω.

‚úÖ **–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:**

- –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é `startService(Intent)`.
- –ù–µ —Å–≤—è–∑–∞–Ω —Å `Activity` –∏ –Ω–µ –º–æ–∂–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å –Ω–∏–º –Ω–∞–ø—Ä—è–º—É—é.
- –†–∞–±–æ—Ç–∞–µ—Ç –¥–æ –≤—ã–∑–æ–≤–∞ `stopSelf()` –∏–ª–∏ `stopService(Intent)`.
- –ù–∞–ø—Ä–∏–º–µ—Ä, **–∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤, –º—É–∑—ã–∫–∞ –≤ —Ñ–æ–Ω–µ, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö.**

üìå **–ü—Ä–∏–º–µ—Ä:**

```kotlin 
class MyService : Service() {
    override fun onStartCommand(intent: Intent?, flags: Int, startId: Int): Int {
        Thread {
            // –î–æ–ª–≥–∞—è —Ñ–æ–Ω–æ–≤–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è (–ø—Ä–∏–º–µ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞)
            downloadFile()
            stopSelf() // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–µ—Ä–≤–∏—Å –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã
        }.start()
        return START_STICKY
    }

    override fun onBind(intent: Intent?): IBinder? = null
}
**–ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞:**
val intent = Intent(this, MyService::class.java)
startService(intent)

```

### **–°–≤—è–∑–∞–Ω–Ω—ã–π (`Bound`)**

üìå –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –∫–æ–≥–¥–∞ `Service` **–¥–æ–ª–∂–µ–Ω –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å `Activity`**, –ø–µ—Ä–µ–¥–∞–≤–∞—è –¥–∞–Ω–Ω—ã–µ –∏ –≤—ã–ø–æ–ª–Ω—è—è –∑–∞–ø—Ä–æ—Å—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

‚úÖ **–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:**

- –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é `bindService(Intent, ServiceConnection, flags)`.
- –ü–æ–∑–≤–æ–ª—è–µ—Ç `Activity` –∏–ª–∏ `Fragment` –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å `Service`.
- –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –µ—Å–ª–∏ –Ω–µ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏—Ö `unbindService()`.
- –ù–∞–ø—Ä–∏–º–µ—Ä, **–º—É–∑—ã–∫–∞–ª—å–Ω—ã–π –ø–ª–µ–µ—Ä, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å Bluetooth, API-–∑–∞–ø—Ä–æ—Å—ã.**
```kotlin 
class BoundService : Service() {
    private val binder = LocalBinder()

    inner class LocalBinder : Binder() {
        fun getService(): BoundService = this@BoundService
    }

    override fun onBind(intent: Intent?): IBinder = binder

    fun getRandomNumber(): Int = (1..100).random()
}

```

üìå **–°–≤—è–∑—ã–≤–∞–Ω–∏–µ —Å `Activity`:**

```kotlin 
class MainActivity : AppCompatActivity() {
    private var service: BoundService? = null
    private var isBound = false

    private val connection = object : ServiceConnection {
        override fun onServiceConnected(name: ComponentName?, binder: IBinder?) {
            val localBinder = binder as BoundService.LocalBinder
            service = localBinder.getService()
            isBound = true
        }

        override fun onServiceDisconnected(name: ComponentName?) {
            isBound = false
        }
    }

    override fun onStart() {
        super.onStart()
        val intent = Intent(this, BoundService::class.java)
        bindService(intent, connection, Context.BIND_AUTO_CREATE)
    }

    override fun onStop() {
        super.onStop()
        if (isBound) {
            unbindService(connection)
            isBound = false
        }
    }
}

```

## **2Ô∏è‚É£ Foreground Service (`–°–µ—Ä–≤–∏—Å –Ω–∞ –ø–µ—Ä–µ–¥–Ω–µ–º –ø–ª–∞–Ω–µ`)**

üìå `Foreground Service` ‚Äî —ç—Ç–æ —Å–µ—Ä–≤–∏—Å, –∫–æ—Ç–æ—Ä—ã–π **—Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ñ–æ–Ω–µ, –Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ**, —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–Ω–∞–ª, —á—Ç–æ –æ–Ω –∞–∫—Ç–∏–≤–µ–Ω.

‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:**

- –ü—Ä–æ–∏–≥—Ä—ã–≤–∞–Ω–∏—è –º—É–∑—ã–∫–∏.
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è GPS.
- –§–æ–Ω–æ–≤–æ–π –∑–∞–ø–∏—Å–∏ –∞—É–¥–∏–æ.
- –ó–∞–ø—É—Å–∫–∞ –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.

üìå **–ü—Ä–∏–º–µ—Ä:**


```kotlin
class ForegroundService : Service() {
    override fun onStartCommand(intent: Intent?, flags: Int, startId: Int): Int {
        val notification = NotificationCompat.Builder(this, "channel_id")
            .setContentTitle("Foreground Service")
            .setContentText("–°–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω")
            .setSmallIcon(R.drawable.ic_launcher_foreground)
            .build()

        startForeground(1, notification)  // –ó–∞–ø—É—Å–∫–∞–µ–º Foreground Service

        return START_STICKY
    }

    override fun onBind(intent: Intent?): IBinder? = null
}

**–ó–∞–ø—É—Å–∫ Foreground Service:**
val intent = Intent(this, ForegroundService::class.java)
startService(intent)




```

## **–†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `Started`, `Bound` –∏ `Foreground` Service**

|–¢–∏–ø `Service`|–ö–∞–∫ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è|–ö–æ–≥–¥–∞ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è|–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è|
|---|---|---|---|
|**Started Service**|`startService(intent)`|`stopSelf()` –∏–ª–∏ `stopService(intent)`|–§–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ (–∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤, API-–∑–∞–ø—Ä–æ—Å—ã)|
|**Bound Service**|`bindService(intent, connection, flags)`|`unbindService(connection)`|–ö–ª–∏–µ–Ω—Ç-—Å–µ—Ä–≤–µ—Ä–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ (–º—É–∑—ã–∫–∞–ª—å–Ω—ã–π –ø–ª–µ–µ—Ä, Bluetooth)|
|**Foreground Service**|`startForeground(id, notification)`|–ö–æ–≥–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —è–≤–Ω–æ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –µ–≥–æ|GPS, –º—É–∑—ã–∫–∞, —Ä–∞–±–æ—Ç–∞ —Å —Å–µ–Ω—Å–æ—Ä–∞–º–∏|
#### –ß—Ç–æ —Ç–∞–∫–æ–µ `JobScheduler`?

	
**JobScheduler** ‚Äì —ç—Ç–æ —Å–∏—Å—Ç–µ–º–Ω—ã–π —Å–µ—Ä–≤–∏—Å, –¥–æ—Å—Ç—É–ø–Ω—ã–π –Ω–∞—á–∏–Ω–∞—è —Å Android 5.0 (API —É—Ä–æ–≤–µ–Ω—å 21), –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º –ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –≤–∏–¥—ã –∑–∞–¥–∞—á (—Ä–∞–±–æ—Ç—ã) –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö. –° –ø–æ–º–æ—â—å—é JobScheduler –º–æ–∂–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∑–∞–¥–∞—á –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∞–∫–∏—Ö —É—Å–ª–æ–≤–∏–π, –∫–∞–∫ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–µ—Ç–∏, –∑–∞—Ä—è–¥ –±–∞—Ç–∞—Ä–µ–∏ –∏ –¥—Ä—É–≥–∏–µ. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ñ–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ, —ç–∫–æ–Ω–æ–º—è –∑–∞—Ä—è–¥ –±–∞—Ç–∞—Ä–µ–∏ –∏ —Ä–µ—Å—É—Ä—Å—ã —Å–∏—Å—Ç–µ–º—ã. –†–∞–±–æ—Ç—ã, –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å –ø–æ–º–æ—â—å—é JobScheduler, –º–æ–≥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –¥–∞–∂–µ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞.

üìå **–ö–∞–∫ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á—É?**
```kotlin 
class MyJobService : JobService() {
    override fun onStartJob(params: JobParameters?): Boolean {
        // –§–æ–Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö)
        Thread {
            Log.d("JobService", "–§–æ–Ω–æ–≤–∞—è —Ä–∞–±–æ—Ç–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è...")
            jobFinished(params, false) // –ó–∞–≤–µ—Ä—à–∞–µ–º —Ä–∞–±–æ—Ç—É
        }.start()
        return true // –í–æ–∑–≤—Ä–∞—â–∞–µ–º true, –µ—Å–ª–∏ –∑–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ —Ñ–æ–Ω–µ
    }

    override fun onStopJob(params: JobParameters?): Boolean {
        return false // false = –∑–∞–¥–∞—á–∞ –ù–ï –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ —Å–±–æ–µ
    }
}
	
```
üìå –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏
```kotlin
val jobScheduler = getSystemService(JobScheduler::class.java)

val jobInfo = JobInfo.Builder(1, ComponentName(this, MyJobService::class.java))
    .setRequiredNetworkType(JobInfo.NETWORK_TYPE_UNMETERED) // –¢–æ–ª—å–∫–æ Wi-Fi
    .setRequiresCharging(true) // –¢–æ–ª—å–∫–æ –ø—Ä–∏ –∑–∞—Ä—è–¥–∫–µ
    .setPeriodic(15 * 60 * 1000) // –ü–æ–≤—Ç–æ—Ä—è—Ç—å –∫–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç
    .build()

jobScheduler.schedule(jobInfo)
```
üìå –û—Ç–º–µ–Ω–∏—Ç—å –∑–∞–¥–∞—á—É
```kotlin 
jobScheduler.cancel(1) // –û—Ç–º–µ–Ω–∏—Ç—å –∑–∞–¥–∞—á—É —Å ID 1
```




[[android]]